---
title: 文件下载
author: 张三
createTime: 2024/06/16 14:36:40
permalink: /article/0qh3uaka/
---
### springboot和vue结合实现压缩包下载

#### 后端

```java
		//压缩文件
        File file = ZipUtil.zip(tableGenerate.getOutputDir());
        byte[] data = FileUtil.readBytes(file);
        //删除文件
        FileUtil.del(file);
        FileUtil.del(tableGenerate.getOutputDir());
        //返回文件流
        response.reset();
        response.addHeader("Access-Control-Allow-Origin", "*");
        response.addHeader("Access-Control-Expose-Headers", "Content-Disposition");
        response.setHeader("Content-Disposition", "attachment;");
        response.addHeader("Content-Length", "" + data.length);
        response.setContentType("application/octet-stream; charset=UTF-8");
        IOUtils.write(data, response.getOutputStream());
```

#### 前端

```vue
this.$http.get("/authorService/tableGenerate/generate?"+"recordId="+row.recordId,{ responseType: 'blob' }).then(res => {
          if (res.data != null) {
            // 处理返回的文件流
            const blob = new Blob([res.data],{type:"application/zip"});
            const fileName =row.tableName+".zip";
            if ("download" in document.createElement("a")) {
              // 非IE下载
              const elink = document.createElement("a");
              elink.download = fileName;
              elink.style.display = "none";
              elink.href = URL.createObjectURL(blob);
              document.body.appendChild(elink);
              elink.click();
              URL.revokeObjectURL(elink.href); // 释放URL 对象
              document.body.removeChild(elink);
            }else {
              navigator.msSaveBlob(blob, fileName);
            }
          }else {
            this.$message.error("生成记录有误");
          }
        })
```

